

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Sequential Data &mdash; Cogitare 0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/julia.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/julia.css" type="text/css" />
  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Cogitare 0.1 documentation" href="index.html"/>
        <link rel="next" title="Async Data Loader" href="async_data.html"/>
        <link rel="prev" title="Data" href="data.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

<a href="https://github.com/cogitare-ai/cogitare"><img style="z-index: 1; position: fixed; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="http://docs.cogitare-ai.org/"><img src="_static/logo-line.png" class="logo"></a>
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#Model">Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#Data-Loading">Data Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#Training">Training</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Cogitare</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="model.html">Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model.html#implementing-a-model">Implementing a Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sequential_model.html">Sequential Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sequential_model.html#implementing-a-sequential-model-many-to-many-many-to-one">Implementing a Sequential Model (Many-to-Many, Many-to-One)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sequential_model.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.html#absdataholder"><span class="hidden-section">AbsDataHolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#tensorholder"><span class="hidden-section">TensorHolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#numpyholder"><span class="hidden-section">NumpyHolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#callableholder"><span class="hidden-section">CallableHolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#autoholder"><span class="hidden-section">AutoHolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#dataset"><span class="hidden-section">DataSet</span></a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Sequential Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sequentialabsdataholder"><span class="hidden-section">SequentialAbsDataHolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#sequentialtensorholder"><span class="hidden-section">SequentialTensorHolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#sequentialnumpyholder"><span class="hidden-section">SequentialNumpyHolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#sequentialcallableholder"><span class="hidden-section">SequentialCallableHolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#sequentialautoholder"><span class="hidden-section">SequentialAutoHolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#sequentialdataset"><span class="hidden-section">SequentialDataSet</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="async_data.html">Async Data Loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plugins.html#custom-plugin">Custom Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html#register-a-plugin">Register a plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html#official-plugins">Official Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#earlystopping"><span class="hidden-section">EarlyStopping</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#evaluator"><span class="hidden-section">Evaluator</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#logger"><span class="hidden-section">Logger</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#plottingmatplotlib"><span class="hidden-section">PlottingMatplotlib</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#progressbar"><span class="hidden-section">ProgressBar</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="monitor.html">Cogitare Monitor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="monitor.html#how-to-use">How to Use</a></li>
<li class="toctree-l2"><a class="reference internal" href="monitor.html#creating-a-custom-plugin">Creating a Custom Plugin</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="metrics.html#module-cogitare.metrics.classification">Classification Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html#module-cogitare.metrics.spatial">Spatial Metrics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">cogitare.utils</a></li>
</ul>
<p class="caption"><span class="caption-text">Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="models/classic.html">Classic Models</a></li>
</ul>
<p class="caption"><span class="caption-text">Extra</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#contributing-to-cogitare">Contributing to Cogitare</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Cogitare</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Sequential Data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/sequential_data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="sequential-data">
<h1>Sequential Data<a class="headerlink" href="#sequential-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="sequentialabsdataholder">
<h2><span class="hidden-section">SequentialAbsDataHolder</span><a class="headerlink" href="#sequentialabsdataholder" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="cogitare.data.SequentialAbsDataHolder">
<em class="property">class </em><code class="descclassname">cogitare.data.</code><code class="descname">SequentialAbsDataHolder</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cogitare/data/sequential_dataholder.html#SequentialAbsDataHolder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cogitare.data.SequentialAbsDataHolder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">cogitare.data.dataholder.AbsDataHolder</span></code></p>
<p>This class is an extension of <a class="reference internal" href="data.html#cogitare.data.AbsDataHolder" title="cogitare.data.AbsDataHolder"><code class="xref py py-class docutils literal"><span class="pre">AbsDataHolder</span></code></a> to support
sequential data, iterating over the batches and over timesteps. Its the recommended
interface for using with <a class="reference internal" href="sequential_model.html#cogitare.SequentialModel" title="cogitare.SequentialModel"><code class="xref py py-class docutils literal"><span class="pre">SequentialModel</span></code></a>.</p>
<p>An abstract object that acts as a data holder. A data holder is a utility to hold
datasets, which provide some simple functions to work with the dataset, such as
sorting, splitting, dividing it into chunks, loading batches using multi-thread, and so on.</p>
<p>It’s the recommended way to pass data to Cogitare’s models because it already
provides a compatible interface to iterate over batches and timesteps.</p>
<p>To improve the performance, the data holder loads batches using multiprocessing and multithreading
data loader with <a class="reference external" href="http://dask.pydata.org/">Dask</a>.</p>
<p>Usually, this object should not be used directly, only if you are developing a custom
data loader. Cogitare already provides the following implementations for the most
common data types:</p>
<blockquote>
<div><ul class="simple">
<li>Sequence from Tensors: <a class="reference internal" href="#cogitare.data.SequentialTensorHolder" title="cogitare.data.SequentialTensorHolder"><code class="xref py py-class docutils literal"><span class="pre">SequentialTensorHolder</span></code></a></li>
<li>Sequence from Numpy: <a class="reference internal" href="#cogitare.data.SequentialNumpyHolder" title="cogitare.data.SequentialNumpyHolder"><code class="xref py py-class docutils literal"><span class="pre">SequentialNumpyHolder</span></code></a></li>
<li>Sequence from Callable (functions that receive the sample id, and returns its
data): <a class="reference internal" href="#cogitare.data.SequentialCallableHolder" title="cogitare.data.SequentialCallableHolder"><code class="xref py py-class docutils literal"><span class="pre">SequentialCallableHolder</span></code></a></li>
<li><a class="reference internal" href="#cogitare.data.SequentialAutoHolder" title="cogitare.data.SequentialAutoHolder"><code class="xref py py-class docutils literal"><span class="pre">SequentialAutoHolder</span></code></a>: inspect the data to choose one of the available data holders.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<a class="reference external" href="http://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (0.4.0a0+b08101e ))"><em>torch.Tensor</em></a><em>, </em><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a>) – the data to be managed by the data holder.</li>
<li><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – the size of the batch.</li>
<li><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – if True, shuffles the dataset after each iteration.</li>
<li><strong>drop_last</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – if True, then skip the batch if its size is lower that <strong>batch_size</strong> (can
occur in the last batch).</li>
<li><strong>total_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – the number of total samples. If provided, this will limit the
number of samples to be accessed in the data.</li>
<li><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – must be one of: ‘sequential’, ‘threaded’, ‘multiprocessing’. Use one of them
to choose the batch loading methods. Take a loook
here: <a class="reference external" href="https://dask.pydata.org/en/latest/scheduler-choice.html">https://dask.pydata.org/en/latest/scheduler-choice.html</a> for an overview
of the advantage of each mode.</li>
<li><strong>padding_value</strong> – this value will be used to pad sequences with different
sizes in the same batch. When loading a batch, all sequences will have
the same size. The padding_value is added to the right of each sequence to match the size
of the longest sequence in the batch.</li>
<li><strong>sort_by_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – if True, the sequences in the batch will be sorted by decreasing size. This is
useful to be load data for torch rnn.PackedSequence. If True, the iterator will return a
tuple with (data, original indices, sizes).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="cogitare.data.SequentialAbsDataHolder.padding_value">
<code class="descname">padding_value</code><a class="headerlink" href="#cogitare.data.SequentialAbsDataHolder.padding_value" title="Permalink to this definition">¶</a></dt>
<dd><p>The value used to pad sequences with different size in the same batch</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sequentialtensorholder">
<h2><span class="hidden-section">SequentialTensorHolder</span><a class="headerlink" href="#sequentialtensorholder" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="cogitare.data.SequentialTensorHolder">
<em class="property">class </em><code class="descclassname">cogitare.data.</code><code class="descname">SequentialTensorHolder</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cogitare/data/sequential_dataholder.html#SequentialTensorHolder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cogitare.data.SequentialTensorHolder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">cogitare.data.sequential_dataholder.SequentialAbsDataHolder</span></code></p>
<p>A data holder for sequences in <a class="reference external" href="http://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (0.4.0a0+b08101e ))"><code class="xref py py-class docutils literal"><span class="pre">torch.Tensor</span></code></a>.</p>
<p>The tensor must have the shape (N, S, *), where:</p>
<blockquote>
<div><ul class="simple">
<li>N is batch size (number of samples in the tensor);</li>
<li>S is the sequence length</li>
</ul>
</div></blockquote>
<p>The <a class="reference internal" href="#cogitare.data.SequentialTensorHolder" title="cogitare.data.SequentialTensorHolder"><code class="xref py py-class docutils literal"><span class="pre">SequentialTensorHolder</span></code></a> will first iterate over the batches,
getting <code class="docutils literal"><span class="pre">batch_size</span></code> samples from the first dimension. And the will iterate over the second
dimension of the mini-batch.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor</span>
<span class="go"> 1  2  3</span>
<span class="go"> 4  5  6</span>
<span class="go"> 7  8  9</span>
<span class="go">[torch.FloatTensor of size 3x3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">SequentialTensorHolder</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span>
<span class="go">[(1.0, 7.0), (2.0, 8.0), (3.0, 9.0)]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Current timestep: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestep</span><span class="p">))</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">Current timestep: 1</span>
<span class="go">(1.0, 7.0)</span>
<span class="go">Current timestep: 2</span>
<span class="go">(2.0, 8.0)</span>
<span class="go">Current timestep: 3</span>
<span class="go">(3.0, 9.0)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="sequentialnumpyholder">
<h2><span class="hidden-section">SequentialNumpyHolder</span><a class="headerlink" href="#sequentialnumpyholder" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="cogitare.data.SequentialNumpyHolder">
<code class="descclassname">cogitare.data.</code><code class="descname">SequentialNumpyHolder</code><span class="sig-paren">(</span><em>data</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cogitare/data/sequential_dataholder.html#SequentialNumpyHolder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cogitare.data.SequentialNumpyHolder" title="Permalink to this definition">¶</a></dt>
<dd><p>When creating the object, it converts the numpy data to Tensor using
<a class="reference external" href="http://pytorch.org/docs/master/torch.html#torch.from_numpy" title="(in PyTorch vmaster (0.4.0a0+b08101e ))"><code class="xref py py-func docutils literal"><span class="pre">torch.from_numpy()</span></code></a> and then creates an <a class="reference internal" href="#cogitare.data.SequentialTensorHolder" title="cogitare.data.SequentialTensorHolder"><code class="xref py py-class docutils literal"><span class="pre">SequentialTensorHolder</span></code></a>
instance.</p>
</dd></dl>

</div>
<div class="section" id="sequentialcallableholder">
<h2><span class="hidden-section">SequentialCallableHolder</span><a class="headerlink" href="#sequentialcallableholder" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="cogitare.data.SequentialCallableHolder">
<em class="property">class </em><code class="descclassname">cogitare.data.</code><code class="descname">SequentialCallableHolder</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cogitare/data/sequential_dataholder.html#SequentialCallableHolder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cogitare.data.SequentialCallableHolder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">cogitare.data.sequential_dataholder.SequentialAbsDataHolder</span></code></p>
<p>SequentialCallableHolder is a data holder for abritary data type.</p>
<p>As data input, it uses a callable that receive the sample index as parameter,
and must return the sample (an interator with all the timesteps for the sample).</p>
<p>It can be used to load non-Tensor or non-numpy datasets, such as texts, dicts, and anything else.
You are free to use SequentialCallableHolder with any data type. As a requirement for sequential models,
the returned value must be an iterator containing the timesteps, and have the length attribute.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using SequentialCallableHolder, you must specify the number of samples
in the dataset. The callable will be called asking for samples from 0 to (total_samples - 1).</p>
</div>
</div></blockquote>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">load_sample</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
<span class="gp">... </span>    <span class="c1"># the idx&#39;th sample with 3 features per timestep, and #idx timesteps</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">idx</span><span class="p">)]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># when using the SequentialCallableHolder. you must pass the number of samples to</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># be loaded.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># you can set the total_samples using the parameter in the constructor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">SequentialCallableHolder</span><span class="p">(</span><span class="n">load_sample</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">total_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or by setting the property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">total_samples</span> <span class="o">=</span> <span class="mi">5</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span>
<span class="go">[((0, 0, 0), (0, 0, 0)), (None, (1, 1, 1)), (None, (2, 2, 2)), (None, (3, 3, 3))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Current timestep: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestep</span><span class="p">))</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">Current timestep: 1</span>
<span class="go">((0, 0, 0), (0, 0, 0))</span>
<span class="go">Current timestep: 2</span>
<span class="go">(None, (1, 1, 1))</span>
<span class="go">Current timestep: 3</span>
<span class="go">(None, (2, 2, 2))</span>
<span class="go">Current timestep: 4</span>
<span class="go">(None, (3, 3, 3))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># in the example above, the first sequence had length 1, and the second</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># length 4. The first one was padded with None.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># to pad with a different value, use:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">SequentialCallableHolder</span><span class="p">(</span><span class="n">load_sample</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">total_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">padding_value</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span>
<span class="go">[((0, 0, 0), (0, 0, 0)), ((1, 1, 1), (1, 1, 1)), ((2, 2, 2), -1), ((3, 3, 3), -1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Current timestep: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestep</span><span class="p">))</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">Current timestep: 1</span>
<span class="go">((0, 0, 0), (0, 0, 0))</span>
<span class="go">Current timestep: 2</span>
<span class="go">((1, 1, 1), (1, 1, 1))</span>
<span class="go">Current timestep: 3</span>
<span class="go">((2, 2, 2), -1)</span>
<span class="go">Current timestep: 4</span>
<span class="go">((3, 3, 3), -1)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="sequentialautoholder">
<h2><span class="hidden-section">SequentialAutoHolder</span><a class="headerlink" href="#sequentialautoholder" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="cogitare.data.SequentialAutoHolder">
<code class="descclassname">cogitare.data.</code><code class="descname">SequentialAutoHolder</code><span class="sig-paren">(</span><em>data</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cogitare/data/sequential_dataholder.html#SequentialAutoHolder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cogitare.data.SequentialAutoHolder" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the data type to infer which sequential data holder to use.</p>
</dd></dl>

</div>
<div class="section" id="sequentialdataset">
<h2><span class="hidden-section">SequentialDataSet</span><a class="headerlink" href="#sequentialdataset" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="cogitare.data.SequentialDataSet">
<em class="property">class </em><code class="descclassname">cogitare.data.</code><code class="descname">SequentialDataSet</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cogitare/data/sequential_dataset.html#SequentialDataSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cogitare.data.SequentialDataSet" title="Permalink to this definition">¶</a></dt>
<dd><p>This object is a container to multiple sequential data holders. Its an extension of
<a class="reference internal" href="data.html#cogitare.data.DataSet" title="cogitare.data.DataSet"><code class="xref py py-class docutils literal"><span class="pre">DataSet</span></code></a>.</p>
<p>Check the <a class="reference internal" href="data.html#cogitare.data.DataSet" title="cogitare.data.DataSet"><code class="xref py py-class docutils literal"><span class="pre">cogitare.data.DataSet</span></code></a> docs for more information.</p>
<p>When creating it, the data parameter must be a list of data sources, and then
the result of the iterator will be a batch got from each data source that contains
timesteps for each sample.</p>
<p>It can be used to group input and target variables, for example, if they are not
on the same object, or two sequences in the case of a sequence to sequnce (seq2seq),
encode-decode model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a>) – list of sequential data holders or list of data (that will be converted to a
data holder using the <a class="reference internal" href="#cogitare.data.SequentialAutoHolder" title="cogitare.data.SequentialAutoHolder"><code class="xref py py-class docutils literal"><span class="pre">SequentialAutoHolder</span></code></a>.</li>
<li><strong>data_types</strong> (<em>dataholder</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a>) – A list of data holder classes to be used to
create the holder for each input.
If it is a list, must have the same size of the data.
If data_types is None, the <a class="reference internal" href="data.html#cogitare.data.AutoHolder" title="cogitare.data.AutoHolder"><code class="xref py py-class docutils literal"><span class="pre">AutoHolder</span></code></a> will be used.</li>
<li><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – the size of each batch.</li>
<li><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – if True, shuffles the samples of each data holder.</li>
<li><strong>drop_last</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – if True, then skip the batch if its size is lower that <strong>batch_size</strong> (can
occur in the last batch).</li>
<li><strong>padding_value</strong> – this value will be used to pad sequences with different
sizes in the same batch. When loading a batch, all sequences will have
the same size. The padding_value is added to the right of each sequence to match the size
of the longest sequence in the batch.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <strong>batch_size</strong>, <strong>shuffle</strong>, and <strong>drop_last</strong> parameters will override the
data holder default values. If you want to keep a different value for each data holder,
get its instance in the <code class="docutils literal"><span class="pre">container</span></code> attribute and edit manually.</p>
</div>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tensor1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor1</span>
<span class="go"> 1  2  3</span>
<span class="go"> 4  5  6</span>
<span class="go"> 7  8  9</span>
<span class="go">[torch.FloatTensor of size 3x3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor2</span>
<span class="go"> 10  11  12</span>
<span class="go"> 13  14  15</span>
<span class="go"> 16  17  18</span>
<span class="go">[torch.FloatTensor of size 3x3]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># you can create the dataset passing the data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">SequentialDataSet</span><span class="p">([</span><span class="n">tensor1</span><span class="p">,</span> <span class="n">tensor2</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or passing data holders</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dh1</span> <span class="o">=</span> <span class="n">SequentialTensorHolder</span><span class="p">(</span><span class="n">tensor1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dh2</span> <span class="o">=</span> <span class="n">SequentialTensorHolder</span><span class="p">(</span><span class="n">tensor1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">SequentialDataSet</span><span class="p">([</span><span class="n">dh1</span><span class="p">,</span> <span class="n">dh2</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span>
<span class="go">[((4.0, 7.0), (13.0, 16.0)), ((5.0, 8.0), (14.0, 17.0)), ((6.0, 9.0), (15.0, 18.0))]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">timestep</span><span class="p">,</span> <span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Current timestep: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestep</span><span class="p">))</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">((</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">))</span>
<span class="go">Current timestep: 1</span>
<span class="go">((4.0, 7.0), (13.0, 16.0))</span>
<span class="go">Current timestep: 2</span>
<span class="go">((5.0, 8.0), (14.0, 17.0))</span>
<span class="go">Current timestep: 3</span>
<span class="go">((6.0, 9.0), (15.0, 18.0))</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="async_data.html" class="btn btn-neutral float-right" title="Async Data Loader" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="data.html" class="btn btn-neutral" title="Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Aron Bordin.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>